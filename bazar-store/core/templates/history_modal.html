<!-- Purchase History Modal -->
<div class="modal fade" id="historyModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title"><i class="bi bi-clock-history me-2"></i>Purchase History</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="historyContainer" class="position-relative">
                    <div class="text-center py-5">
                        <div class="spinner-border text-primary" role="status"></div>
                        <p class="mt-3">Loading purchase history...</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <!-- Report buttons will be added here dynamically by history.js -->
            </div>
        </div>
    </div>
</div>

<!-- Add script reference to history.js if not already included in your main template -->
<script>
    // Ensure the history module is initialized when this modal is included
    document.addEventListener('DOMContentLoaded', function() {
        // Add click event to any elements with the show-history action
        const historyLinks = document.querySelectorAll('[data-action="show-history"]');
        historyLinks.forEach(link => {
            link.addEventListener('click', function() {
                if (window.historyModule && window.historyModule.showPurchaseHistory) {
                    window.historyModule.showPurchaseHistory();
                }
            });
        });
    });
</script>